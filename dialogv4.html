<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base target="_top">
    <style>
      /* Google Fonts */
      @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap');

      /* General Body Style */
      body {
        font-family: 'Roboto', sans-serif;
        background-color: #f7f7f7;
        margin: 0;
        padding: 0;
        color: #333;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        box-sizing: border-box;
      }

      /* Dialog Container */
      .dialog-container {
        width: 100%;
        max-width: 400px;
        background-color: #fff;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0px 4px 12px rgba(0, 0, 0, 0.1);
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      h3 {
        font-size: 24px;
        color: #333;
        margin-bottom: 20px;
        text-align: center;
      }

      label {
        font-size: 16px;
        font-weight: 500;
        margin-bottom: 8px;
        display: block;
        width: 100%;
        color: #333;
      }

      /* Modern Style for Select Elements */
      select {
        width: 100%;
        padding: 14px;
        margin-bottom: 16px;
        font-size: 16px;
        border-radius: 8px;
        border: 1px solid #ddd;
        background-color: #f9f9f9;
        color: #333;
        outline: none;
        cursor: pointer;
        transition: all 0.3s ease;
        box-sizing: border-box;
      }

      /* Focus Effect */
      select:focus {
        border: 1px solid #6200ea;
        background-color: #fff;
      }

      /* Dropdown Option Styling */
      option {
        font-size: 16px;
        padding: 10px;
        color: #333;
        background-color: #f9f9f9;
      }

      option:hover {
        background-color: #e8e8e8;
      }

      /* Button Style */
      button {
        background-color: #6200ea;
        color: white;
        padding: 12px 24px;
        border: none;
        border-radius: 6px;
        font-size: 16px;
        cursor: pointer;
        transition: background-color 0.3s ease, transform 0.3s ease;
        width: 100%; /* Makes the button full-width */
      }

      button:hover {
        background-color: #3700b3;
        transform: translateY(-3px);
      }

      button:focus {
        outline: none;
      }

      /* Focused Button */
      button:active {
        transform: translateY(1px);
      }

      /* Small Screen Adjustments */
      @media (max-width: 480px) {
        .dialog-container {
          padding: 15px;
          width: 90%;
        }
      }
    </style>
  </head>
  <body>
    <div class="dialog-container">
      <h3>Personalización de Carátula</h3>

      <label for='course'>Curso:</label>
      <select id="course">
        <!-- Dynamically filled -->
      </select>
      
      <label for='teacher'>Profesor:</label>
      <select id="teacher">
        <!-- Dynamically filled -->
      </select>

      <label for="student">Estudiante:</label>
      <select id="student">
        <!-- Dynamically filled -->
      </select>

      <label for="font">Fuente:</label>
      <select id="font">
        <option value="Arial">Arial</option>
        <option value="Times New Roman">Times New Roman</option>
      </select>

      <!-- Centered button -->
      <button onclick='insert()'>Crear carátula</button>
    </div>

    <script>
      window.onload = function () {
        google.script.run.withSuccessHandler(function(data) {
          const teachers = data.teacherNames;
          const courses = data.courseNames;
          const students = data.studentNames;

          const teacherSelect = document.getElementById('teacher');
          const courseSelect = document.getElementById('course');
          const studentSelect = document.getElementById('student');

          function fillSelect(selectElement, items) {
            selectElement.innerHTML = "";
            items.forEach(item => {
              const option = document.createElement('option');
              option.value = item;
              option.textContent = item;
              selectElement.appendChild(option);
            });
          }

          fillSelect(courseSelect, courses);
          fillSelect(teacherSelect, teachers);
          fillSelect(studentSelect, students);

        }).getData();
      };

      function insert() {
        const course = document.getElementById('course').value;
        const teacher = document.getElementById('teacher').value;
        const student = document.getElementById('student').value;
        const font = document.getElementById('font').value;

        // Run the createCover function to generate the cover
        google.script.run.createCover(course, teacher, student, font);

        // Close dialog after creating the cover
        google.script.host.close();
      }
    </script>
  </body>
</html>